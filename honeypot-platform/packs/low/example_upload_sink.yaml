{
  "apiVersion": "hoho.dev/v1",
  "kind": "HoneypotPack",
  "metadata": {
    "id": "example-upload-sink",
    "name": "Upload Sink Honeypot",
    "interaction": "low",
    "tags": ["upload", "api"],
    "description": "Accepts multipart and stores uploads as artifacts."
  },
  "storage": {"backend": "filesystem", "root": "./run/artifacts"},
  "limits": {"max_body_bytes": 2097152, "max_upload_bytes": 10485760, "max_artifacts_per_request": 5},
  "telemetry": {"emit_events": true, "redact_headers": ["Authorization", "Cookie"]},
  "listen": [{"host": "0.0.0.0", "port": 8081}],
  "behaviors": [
    {
      "name": "upload-api",
      "match": {"method": "POST", "path": "/api/upload", "contentTypeContains": "multipart/form-data"},
      "actions": [
        {"emit_event": {"verdict": "upload", "tags": ["multipart"], "indicators": ["file-upload"]}},
        {"store_body": {"kind": "request_body", "gzip": true}},
        {"respond": {"status": 201, "headers": {"Content-Type": "application/json"}, "body": "{\"ok\":true,\"id\":\"fake-123\"}"}}
      ]
    }
  ]
}
