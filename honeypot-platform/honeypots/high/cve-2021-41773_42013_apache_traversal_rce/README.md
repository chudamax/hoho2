# High-Interaction Honeypot: Apache 2.4.49/2.4.50 Traversal RCE

## Overview
- CVEs: `CVE-2021-41773` (path traversal + file disclosure) and `CVE-2021-42013` (path traversal + RCE when CGI is enabled).
- Product: Apache HTTP Server (`httpd`) vulnerable branch `2.4.49/2.4.50`.
- Pack file: `packs/high/cve-2021-41773_42013_apache_traversal_rce.yaml`.

## Capture plan
This honeypot prioritizes full attacker workflow visibility with currently supported sensors:
- PCAP rotation via `pcap-sensor`.
- Reverse-proxy request/response metadata + request body capture via `proxy-sensor`.
- Filesystem monitoring for web content, CGI paths, and `/tmp` via `fsmon-sensor`.

Process telemetry is best-effort in this repository; add host eBPF/audit integrations in deployment environments that support them.

## Run
From `honeypot-platform/`:

```bash
hoho validate packs/high/cve-2021-41773_42013_apache_traversal_rce.yaml
hoho run packs/high/cve-2021-41773_42013_apache_traversal_rce.yaml
```

If you prefer manual compose:

```bash
hoho render-compose packs/high/cve-2021-41773_42013_apache_traversal_rce.yaml
docker compose -f deploy/compose/cve-2021-41773_42013_apache_traversal_rce/docker-compose.yml up -d
```

## Stop
```bash
docker compose -f deploy/compose/cve-2021-41773_42013_apache_traversal_rce/docker-compose.yml down -v
```

## One-command reset
Use `./honeypots/high/cve-2021-41773_42013_apache_traversal_rce/reset.sh`.
- Stops/removes prior compose project.
- Creates a new session artifact folder under `run/artifacts/high/cve-2021-41773_42013_apache_traversal_rce/<session-id>/`.
- Re-renders compose with that artifact root.
- Starts a fresh stack.

## Ports and exposure
- Host `8091` -> proxy sensor -> Apache `80`.

## Egress policy
- Default deployment leaves container egress unchanged.
- For production capture zones, enforce network policy with deny-all or proxy-only egress at infrastructure layer.

## Artifact directory structure
Each reset/run creates a session root:

```text
run/artifacts/high/cve-2021-41773_42013_apache_traversal_rce/<session-id>/
  cve-2021-41773_42013_apache_traversal_rce/
    index/events.jsonl
    blobs/
```

## Safety notes
- Treat this target as compromised-by-design.
- Deploy in isolated network segments only.
- Use dedicated artifact storage and retention policy to avoid disk exhaustion.
