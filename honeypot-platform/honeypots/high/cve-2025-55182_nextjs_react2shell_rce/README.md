# High-Interaction Honeypot: React / Next.js RSC “React2Shell” (CVE-2025-55182)

## Honeypot ID
- `honeypot_id`: `cve-2025-55182_nextjs_react2shell_rce`
- Pack YAML: `honeypot-platform/honeypots/high/cve-2025-55182_nextjs_react2shell_rce/honeypot.yaml`

## Stack
- Service: `nextjs` (`node:20-alpine`)
- Exposed host port: `8105` (service port `3000`)
- Lure behavior:
  - Next.js-like root page (`/`)
  - React Server Components-like flight endpoint (`/_next/flight`)
  - Server-actions endpoint (`/_next/server-actions`) that stores payload snippets for analysis

## Sensors enabled
- `proxy` (reverse proxy): captures inbound HTTP request/response metadata + request bodies.
- `fsmon`: watches writable mounted paths (`/tmp`, `/var/lib/nextcache`) for dropped payloads and staged content.
- `pcap`: packet capture for network ground truth.
- `egress_proxy` with TLS MITM enabled: captures outbound fetches and downloaded tooling payloads.

## Validate + run
From `honeypot-platform/`:

```bash
PYTHONPATH=packages/hoho_core:packages/hoho_runtime \
  python -m hoho_runtime.cli validate honeypots/high/cve-2025-55182_nextjs_react2shell_rce/honeypot.yaml

PYTHONPATH=packages/hoho_core:packages/hoho_runtime \
  python -m hoho_runtime.cli run honeypots/high/cve-2025-55182_nextjs_react2shell_rce
```

## Harmless test requests
See `sample_requests/` for benign probes. Quick examples:

```bash
curl -i http://localhost:8105/
curl -i -X POST 'http://localhost:8105/_next/server-actions?action=ping' \
  -H 'content-type: application/json' \
  --data '{"action":"healthcheck"}'
```

## Artifacts
Artifacts are written to:

- `honeypot-platform/run/artifacts/cve-2025-55182_nextjs_react2shell_rce/`

The runtime uses overwrite semantics for this honeypot ID.

## Stop / cleanup
- Stop all honeypots:

```bash
hoho down-all --volumes
```

- Per-honeypot manual stop:

```bash
docker compose -p "hoho-cve-2025-55182_nextjs_react2shell_rce" \
  -f deploy/compose/cve-2025-55182_nextjs_react2shell_rce/docker-compose.yml down -v
```

## Safety and limitations
- This is a telemetry-focused lure that emulates suspicious Next.js/RSC endpoints; it is not a full vulnerable production Next.js runtime.
- Keep this honeypot isolated from production networks and services.
