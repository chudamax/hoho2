# High-Interaction Honeypot: GeoServer CVE-2024-36401

## Honeypot ID
- `honeypot_id`: `cve-2024-36401_geoserver_rce`
- Pack YAML: `honeypot-platform/honeypots/high/cve-2024-36401_geoserver_rce/honeypot.yaml`

## Stack
- Service: `geoserver` (`kartoza/geoserver:2.24.2`)
- Exposed host port: `8110` (service port `8080`)
- Purpose: emulate a realistic GeoServer attack surface where unauthenticated request payloads targeting OGC endpoints can be observed and correlated with filesystem + network side effects.

## Sensors enabled
- `proxy` (reverse proxy): captures inbound HTTP request/response metadata and request bodies headed to GeoServer endpoints.
- `fsmon`: watches mounted writable paths (`/opt/geoserver_data`, `/tmp`, `/var/tmp`) for dropped files and suspicious modifications.
- `pcap`: captures packet-level network telemetry.
- `egress_proxy` with TLS MITM: captures outbound payload/tooling fetches commonly seen in post-exploitation flows.

## Validate + run
From `honeypot-platform/`:

```bash
PYTHONPATH=packages/hoho_core:packages/hoho_runtime \
  python -m hoho_runtime.cli validate honeypots/high/cve-2024-36401_geoserver_rce/honeypot.yaml

PYTHONPATH=packages/hoho_core:packages/hoho_runtime \
  python -m hoho_runtime.cli run honeypots/high/cve-2024-36401_geoserver_rce
```

## Harmless test requests
See `sample_requests/` for benign probes. Quick examples:

```bash
curl -i "http://localhost:8110/geoserver/web/"
curl -i "http://localhost:8110/geoserver/ows?service=WFS&request=GetCapabilities"
curl -i -X POST "http://localhost:8110/geoserver/wfs" \
  -H 'Content-Type: application/xml' \
  --data-binary @honeypot-platform/honeypots/high/cve-2024-36401_geoserver_rce/sample_requests/benign_getfeature.xml
```

## Artifacts
Artifacts are written to:

- `honeypot-platform/run/artifacts/cve-2024-36401_geoserver_rce/`

The runtime uses overwrite semantics for this honeypot ID.

## Stop / cleanup
- Stop all honeypots:

```bash
hoho down-all --volumes
```

- Per-honeypot manual stop:

```bash
docker compose -p "hoho-cve-2024-36401_geoserver_rce" \
  -f deploy/compose/cve-2024-36401_geoserver_rce/docker-compose.yml down -v
```

- One-command reset:

```bash
./honeypot-platform/honeypots/high/cve-2024-36401_geoserver_rce/reset.sh
```

## Safety and limitations
- This honeypot is intended for telemetry collection and threat research, not for production geospatial workloads.
- Keep deployment isolated from trusted internal networks and production credentials.
